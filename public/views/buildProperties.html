<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="en" ng-app="CDash">
  <head ng-controller="HeadController">
    <meta charset="UTF-8">
    <meta name="robots" content="noindex,nofollow" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="stylesheet" type="text/css" ng-href="{{cssfile}}" />
    <link rel="stylesheet" type="text/css" href="css/nv.d3.css"/>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/jquery-ui-1.10.4.css" />
    <script src="js/CDash_@@version.min.js"></script>
    <title ng-bind="title">CDash : Build Properties</title>
  </head>

  <body bgcolor="#ffffff" ng-controller="BuildPropertiesController">
    <div ng-if="cdash.requirelogin == 1" ng-include="'login.php'"></div>
    <ng-include ng-if="cdash.requirelogin != 1" src="cdash.header || 'build/views/partials/header_@@version.html'"></ng-include>
    <br/>

    <div ng-if="cdash.requirelogin != 1 && !loading && !cdash.error" class="container">

      <h4 class="text-center">Consider builds unclean if they contain any</h4>
      <div class="row">
        <div class="text-center">
          <label class="checkbox-inline"
                 ng-repeat="defecttype in ::cdash.defecttypes track by $index">
            <input type="checkbox" value="" ng-model="defecttype.selected"> {{::defecttype.prettyname}}
          </label>
        </div>
      </div>

      <div ng-if="::cdash.builds.length == 0">
        <div class="row spacer50">
          <p class="col-md-12">
            No builds found during this time period.
          </p>
        </div>
      </div>

      <div ng-if="::cdash.builds.length > 0">
        <h4 class="text-center spacer50">Query Build Properties</h4>

        <div id="chart" class="row">
          <svg style="height:500px"></svg>
        </div>

        <div ng-repeat="selection in cdash.selections" class="animate-show">
          <div class="row">
            <div class="form-inline text-center">
              <div class="form-group">
                <label>Define Selection</label>
                <input type="text" class="form-control" placeholder="Selection Name" ng-model="selection.name"/>
              </div>
            </div>
          </div>
          <div class="form-inline text-center">
            <input type="text" class="form-control" placeholder="Property"
                   ng-model="selection.property"
                   ng-change="updateComparators(selection)"
                   auto-complete available-values="cdash.propertykeys" />
            <select class="form-control"
                    ng-model="selection.comparator"
                    ng-options="obj.text for obj in selection.comparators | orderBy:'pos' track by obj.symbol">
              <option value="" disabled selected hidden>Comparator</option>
            </select>
            <input type="text" class="form-control" placeholder="Value" ng-model="selection.value"/>
            <button type="submit" class="btn btn-default"
                    ng-click="applySelection(selection)"
                    ng-disabled="!selection.name || !selection.property || !selection.comparator || !selection.value">Apply</button>
            <button type="submit" class="btn btn-default"
                    ng-click="removeSelection(selection)"
                    ng-disabled="!selection.applied">-</button>
          </div>
          <div ng-show="selection.error" class="text-danger">
            <b>Error applying selection: {{selection.error}}</b>
          </div>
        </div>
      </div>
    </div>

    <!-- FOOTER -->
    <br/>
    <ng-include ng-if="cdash.requirelogin != 1" src="cdash.footer || 'build/views/partials/footer_@@version.html'"></ng-include>
  </body>
</html>
